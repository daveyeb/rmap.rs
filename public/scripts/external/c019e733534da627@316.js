import define1 from"./a33468b95d0b15b0@817.js";import{tally,populate}from"./util.js";function _2(t,r,e){return t({color:_color(r,_types(e))})}function _chart(t,r,e,a,n){const o=_drag(t),i=_linkArc(),l=_types(n),c=_color(t,l),d=_height(),f=_data(n),s=f.links.map((t=>Object.create(t))),u=f.nodes.map((t=>Object.create(t))),p=t.forceSimulation(u).force("link",t.forceLink(s).id((t=>t.id))).force("charge",t.forceManyBody().strength(-300)).force("x",t.forceX()).force("y",t.forceY()).force("collide",t.forceCollide((t=>65))),h=t.create("svg").attr("viewBox",[-r/2,-d/2,r,d]).attr("style","width: 100%; height: 100%;");h.append("defs").selectAll("marker").data(l).join("marker").attr("id",(t=>`arrow-${t}`)).attr("viewBox","0 -5 10 10").attr("refX",38).attr("refY",0).attr("markerWidth",6).attr("markerHeight",6).attr("orient","auto").append("path").attr("fill",c).attr("d","M0,-5L10,0L0,5");const k=h.append("g").attr("fill","none").attr("stroke-width",1.5).selectAll("path").data(s).join("path").attr("stroke",(t=>c(t.type))).attr("marker-end",(t=>`url(${new URL(`#arrow-${t.type}`,e)})`)),y=h.append("g").attr("fill","currentColor").attr("stroke-linecap","round").attr("stroke-linejoin","round").selectAll("g").data(u).join("g").call(o(p));return y.append("circle").attr("stroke","white").attr("stroke-width",1.5).attr("r",25).attr("fill",(t=>"#6baed6")),y.append("text").attr("x",34).attr("y","0.31em").text((t=>t.id)).clone(!0).lower().attr("fill","none").attr("stroke","white").attr("stroke-width",3),p.on("tick",(()=>{k.attr("d",i),y.attr("transform",(t=>`translate(${t.x},${t.y})`))})),a.then((()=>p.stop())),h.node()}function _types(t){return Array.from(new Set(t.map((t=>t.type))))}function _data(t){return{nodes:Array.from(new Set(t.flatMap((t=>[t.source,t.target]))),(t=>({id:t}))),links:t}}function _height(){return 800}function _color(t,r){return t.scaleOrdinal(r,t.schemeCategory10)}function _linkArc(){return t=>`M${t.source.x},${t.source.y}A0,0 0 0,1 ${t.target.x},${t.target.y}`}function _drag(t){return r=>t.drag().on("start",(function(t,e){t.active||r.alphaTarget(.3).restart(),e.fx=e.x,e.fy=e.y})).on("drag",(function(t,r){r.fx=t.x,r.fy=t.y})).on("end",(function(t,e){t.active||r.alphaTarget(0),e.fx=null,e.fy=null}))}function _d3(t){return t("d3@6")}var links;export function define(t,r){const e=t.module();var a=tally(links);populate(links,a),e.variable(r()).define(["swatches","d3","links"],_2),e.variable(r("chart")).define("chart",["d3","width","location","invalidation","links"],_chart);const n=t.module(define1);return e.builtin("d3",_d3),e.import("swatches",n),e}export function link(t){links=t}